{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { backServer } from \"@/config/axiosConfig\";\nimport { io } from \"socket.io-client\";\nexport default {\n  data() {\n    return {\n      index: -1,\n      id: localStorage.getItem(\"id\"),\n      username: localStorage.getItem(\"username\"),\n      user: {},\n      users: [],\n      newMessage: null,\n      messages: [{\n        message: \"bonjour\",\n        user: \"Rotsy\",\n        type: 1\n      }, {\n        message: \"De akory\",\n        user: \"Diary\",\n        type: 0\n      }, {\n        message: \"cava\",\n        user: \"Rotsy\",\n        type: 1\n      }],\n      socket: null\n    };\n  },\n  created() {\n    this.socket = io(\"http://127.0.0.1:\");\n    this.getUsers();\n  },\n  beforeDestroy() {\n    this.disconnect();\n  },\n  methods: {\n    getUsers() {\n      backServer.get(`/getUsers/${this.id}`).then(res => {\n        this.users = [...res.data.user];\n      }).catch(err => {\n        console.log(err);\n      });\n    },\n    selectUser(ind) {\n      console.log(this.id, ' and index: ', ind);\n      this.user = this.users.find(user => user.id === ind);\n      this.index = ind;\n    },\n    joinRoom(anotherID) {\n      this.socket.emit('join', `${this.id}--with--${anotherID}`);\n    },\n    getMessages() {\n      this.socket.on('message', message => {\n        this.messages.push(message.text);\n      });\n    },\n    sendMessage() {\n      if (!this.newMessage) return;\n      this.socket.emit('sendMessage', this.newMessage);\n      this.newMessage = '';\n    },\n    disconnect() {\n      if (this.socket) this.socket.disconnect();\n    }\n  }\n};","map":{"version":3,"names":["backServer","io","data","index","id","localStorage","getItem","username","user","users","newMessage","messages","message","type","socket","created","getUsers","beforeDestroy","disconnect","methods","get","then","res","catch","err","console","log","selectUser","ind","find","joinRoom","anotherID","emit","getMessages","on","push","text","sendMessage"],"sources":["src/views/Chat.vue"],"sourcesContent":["<template>\n  <section class=\"pt-5\">\n    <div class=\"container shadow-lg section-sm rounded\">\n      <div class=\"row\">\n        <div class=\"col-lg-3\">\n          <ul class=\"sidenav\" v-for=\"user in users\" :key=\"user.id\">\n            <li class=\"sidelist c-type\" @click=\"selectUser(user.id)\">\n              <span :class=\"index == user.id && 'isActive'\">{{\n                user.username\n              }}</span>\n            </li>\n          </ul>\n        </div>\n        <div class=\"col-lg-8 \">\n          <div class=\"mx-5 message\">\n              \n              <div v-if=\"user.username\" class=\"d-flex flex-column\">\n                <div>\n                  <h4>{{user.username}} <span class=\"float-end\">connections</span></h4>\n                </div>\n                <div class=\" rounded-5 mb-3 shadow \">\n                  <ul class=\"list-group rounded-5 list-group-flush list-unstyled text-end\">\n                    <li class=\"list-group-item list-unstyled\" v-for=\"(message, index) in messages\" :key=\"index\" >\n                      <span class=\"message-font\" :class=\"{ 'float-start': message.type === 1 }\">\n                        {{ message.message }}\n                        <small>:{{ message.user }}</small>\n                      </span>\n                    </li>\n                  </ul>\n                </div>\n                <div class=\"search-wrapper d-sm-flex\">\n                    <input id=\"search-by\" name=\"s\" type=\"email\" class=\"form-control form-control-sm\" placeholder=\"Your message here\" style=\"width:100%\" v-model=\"newMessage\" @keypress.enter=\"sendMessage\">\n                    <input type=\"submit\" class=\"btn btn-primary btn-sm\" value=\"Send\" @click=\"sendMessage\">\n                </div>\n              </div>\n\n              <div v-else class=\"text-center\">\n                <p  class=\"message\" >Choose an user to send message</p>\n              </div>\n             \n            </div>\n        </div>\n      </div>\n    </div>\n  </section>\n</template>\n<script>\nimport { backServer } from \"@/config/axiosConfig\";\nimport { io }  from \"socket.io-client\"\n\nexport default {\n  data() {\n    return {\n      index: -1,\n      id: localStorage.getItem(\"id\"),\n      username: localStorage.getItem(\"username\"),\n      user:{},\n      users: [],\n      newMessage: null,\n      messages: [\n        { message: \"bonjour\", user: \"Rotsy\", type: 1 },\n        { message: \"De akory\", user: \"Diary\", type: 0 },\n        { message: \"cava\", user: \"Rotsy\", type: 1 },\n      ],\n      socket: null\n      \n    };\n  },\n  created() {\n    this.socket = io(\"http://127.0.0.1:\")\n    this.getUsers()\n  },\n  beforeDestroy()\n  {\n      this.disconnect()\n  },\n  methods: {\n    getUsers() {\n      backServer\n        .get(`/getUsers/${this.id}`)\n        .then((res) => {\n          this.users = [...res.data.user];\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    selectUser(ind) {\n      console.log(this.id, ' and index: ', ind)\n      this.user = this.users.find((user) => user.id === ind )\n      this.index = ind;\n    },\n    joinRoom(anotherID){\n      this.socket.emit('join', `${this.id}--with--${anotherID}`)\n    },\n    getMessages(){\n       this.socket.on('message',(message) => {\n          this.messages.push(message.text)\n        })\n    },\n    sendMessage()\n    {\n      if(!this.newMessage) return\n      this.socket.emit('sendMessage', this.newMessage)\n      this.newMessage = ''\n    },\n    disconnect()\n    {\n      if(this.socket) this.socket.disconnect()\n    }\n  },\n  \n};\n</script>\n<style scoped>\n  .rounded-5{\n    border-radius: 5px !important;\n  }\n  .message{\n    position: relative;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    font-size: 16px;\n  }\n  .message-font{\n    font-size: 13px;\n  }\n</style>"],"mappings":";AA+CA,SAAAA,UAAA;AACA,SAAAC,EAAA;AAEA;EACAC,KAAA;IACA;MACAC,KAAA;MACAC,EAAA,EAAAC,YAAA,CAAAC,OAAA;MACAC,QAAA,EAAAF,YAAA,CAAAC,OAAA;MACAE,IAAA;MACAC,KAAA;MACAC,UAAA;MACAC,QAAA,GACA;QAAAC,OAAA;QAAAJ,IAAA;QAAAK,IAAA;MAAA,GACA;QAAAD,OAAA;QAAAJ,IAAA;QAAAK,IAAA;MAAA,GACA;QAAAD,OAAA;QAAAJ,IAAA;QAAAK,IAAA;MAAA,EACA;MACAC,MAAA;IAEA;EACA;EACAC,QAAA;IACA,KAAAD,MAAA,GAAAb,EAAA;IACA,KAAAe,QAAA;EACA;EACAC,cAAA,EACA;IACA,KAAAC,UAAA;EACA;EACAC,OAAA;IACAH,SAAA;MACAhB,UAAA,CACAoB,GAAA,mBAAAhB,EAAA,IACAiB,IAAA,CAAAC,GAAA;QACA,KAAAb,KAAA,OAAAa,GAAA,CAAApB,IAAA,CAAAM,IAAA;MACA,GACAe,KAAA,CAAAC,GAAA;QACAC,OAAA,CAAAC,GAAA,CAAAF,GAAA;MACA;IACA;IACAG,WAAAC,GAAA;MACAH,OAAA,CAAAC,GAAA,MAAAtB,EAAA,kBAAAwB,GAAA;MACA,KAAApB,IAAA,QAAAC,KAAA,CAAAoB,IAAA,CAAArB,IAAA,IAAAA,IAAA,CAAAJ,EAAA,KAAAwB,GAAA;MACA,KAAAzB,KAAA,GAAAyB,GAAA;IACA;IACAE,SAAAC,SAAA;MACA,KAAAjB,MAAA,CAAAkB,IAAA,iBAAA5B,EAAA,WAAA2B,SAAA;IACA;IACAE,YAAA;MACA,KAAAnB,MAAA,CAAAoB,EAAA,YAAAtB,OAAA;QACA,KAAAD,QAAA,CAAAwB,IAAA,CAAAvB,OAAA,CAAAwB,IAAA;MACA;IACA;IACAC,YAAA,EACA;MACA,UAAA3B,UAAA;MACA,KAAAI,MAAA,CAAAkB,IAAA,qBAAAtB,UAAA;MACA,KAAAA,UAAA;IACA;IACAQ,WAAA,EACA;MACA,SAAAJ,MAAA,OAAAA,MAAA,CAAAI,UAAA;IACA;EACA;AAEA"},"metadata":{},"sourceType":"module","externalDependencies":[]}